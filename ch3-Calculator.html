<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ใบสั่งซื้อสินค้า</title>
    <style>
        body {
            font-family: Tahoma, sans-serif;
            max-width: 600px;
            margin: 20px auto;
        }

        .receipt {
            border-top: 1px dashed #888;
            margin-top: 20px;
            padding-top: 10px;
        }

        .error {
            color: red;
        }

        .success {
            color: green;
        }

        input[type=number] {
            width: 60px;
            padding: 5px;
        }
    </style>
</head>

<body>
    <h2>ระบบสั่งซื้อสินค้า</h2>
    <form onsubmit="return processOrder()">
        <p><strong>สินค้า:</strong> สินค้า A</p>
        <p><strong>ราคาต่อชิ้น:</strong> <span id="price">120</span> บาท</p>
        <p>
            <label for="qty">จำนวน:</label>
            <input type="number" id="qty" value="1" min="1" max="100" onchange="updateTotal()">
        </p>
        <p><strong>ราคารวม:</strong> <span id="total">120</span> บาท</p>
        <p id="message"></p>
        <button type="submit">ยืนยันการสั่งซื้อ</button>
    </form>
    <div id="receipt" class="receipt"></div>

    <script>
        // Function to update the total price when the quantity changes
        function updateTotal() {
            const qtyInput = document.getElementById("qty");
            let qty = parseInt(qtyInput.value);
            const price = parseFloat(document.getElementById("price").textContent);

            // Ensure quantity is within the valid range (1-100)
            if (isNaN(qty) || qty < 1) {
                qty = 1; // Default to 1 if invalid or less than 1
            } else if (qty > 100) {
                qty = 100; // Cap at 100 if greater than 100
            }
            qtyInput.value = qty; // Update the input field with the corrected value

            const total = qty * price;
            document.getElementById("total").textContent = total;
        }

        // Function to process the order when the purchase is confirmed
        function processOrder() {
            const qtyInput = document.getElementById("qty");
            let qty = parseInt(qtyInput.value);
            const price = parseFloat(document.getElementById("price").textContent);
            const messageBox = document.getElementById("message");
            const receiptBox = document.getElementById("receipt");

            // Clear previous messages and receipt
            messageBox.textContent = "";
            messageBox.className = "";
            receiptBox.innerHTML = "";

            // Check if the quantity is within the 1-100 range
            if (isNaN(qty) || qty < 1 || qty > 100) {
                messageBox.textContent = "❌ กรุณาป้อนจำนวนสินค้าในช่วง 1–100";
                messageBox.className = "error";
                return false; // Prevent form submission
            }

            // Calculate the total price
            const total = qty * price;

            // Display success message
            messageBox.textContent = "✅ การสั่งซื้อสำเร็จ!";
            messageBox.className = "success";

            // Generate a simple receipt
            const receiptHTML = `
                <h3>ใบเสร็จ</h3>
                <p>สินค้า: สินค้า A</p>
                <p>ราคาต่อชิ้น: ${price} บาท</p>
                <p>จำนวน: ${qty} ชิ้น</p>
                <p><strong>รวมทั้งสิ้น: ${total} บาท</strong></p>
            `;
            receiptBox.innerHTML = receiptHTML;

            return false; // Prevent actual form submission
        }
    </script>
</body>

</html>